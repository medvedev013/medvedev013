name: Update README with Latest Blog Posts

on:
  schedule:
    - cron: '0 * * * *'
  workflow_dispatch: # ‚Üê –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ! –ë–µ–∑ —ç—Ç–æ–≥–æ –Ω–µ—Ç —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

jobs:
  update-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0 # –í–∞–∂–Ω–æ –¥–ª—è –∫–æ–º–º–∏—Ç–æ–≤

      - name: Fetch blog posts from Dev.to
        uses: gautamkrishnar/blog-post-workflow@v1.9
        with:
          max_post_count: "4"
          feed_list: "https://dev.to/feed/medvedev013" # üî• –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ô –ù–ò–ö!
          template: |
            <!-- BLOG-POST-LIST:START -->
            ## üìù Latest Articles

            {{#each posts}}
            - [{{title}}]({{link}}) ‚Äî _{{date}}_
            {{/each}}
            <!-- BLOG-POST-LIST:END -->

      - name: Check for changes and commit
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add README.md
          if git diff --cached --quiet; then
            echo "‚úÖ No changes detected. README is up to date."
          else
            git commit -m "chore: update README with latest blog posts"
            git push
            echo "‚úÖ README updated successfully!"
          fi